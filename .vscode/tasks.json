{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "Check Virtual Environment",
            "type": "shell",
            "command": "if (-not $env:VIRTUAL_ENV) { Write-Error 'Virtual environment not activated' -ErrorAction Stop }",
            "problemMatcher": []
        },
        {
            "label": "Run Flask App",
            "type": "shell",
            "command": "${command:python.interpreterPath} -m flask run",
            "options": {
                "env": {
                    "FLASK_APP": "app.py",
                    "FLASK_ENV": "development",
                    "PYTHONPATH": "${workspaceFolder}"
                }
            },
            "dependsOn": ["Check Virtual Environment"],
            "problemMatcher": []
        },
        {
            "label": "open-edge-browser",
            "type": "shell",
            "command": "powershell -Command \"Start-Sleep -Seconds 2; $existing = Get-Process msedge | Where-Object {$_.MainWindowTitle -like '*localhost:5000*'}; if (-not $existing) { start msedge http://localhost:5000 }\"",
            "dependsOn": ["Run Flask App"],
            "problemMatcher": []
        },
        {
            "label": "Start Application",
            "dependsOn": ["Run Flask App", "open-edge-browser"],
            "group": {
                "kind": "test",
                "isDefault": true
            }
        },
        {
            "label": "Run CI Locally",
            "type": "shell",
            "command": "act",
            "args": [
                "push",
                "--workflows",
                ".github/workflows/ci.yml"
            ],
            "group": {
                "kind": "test",
                "isDefault": true
            },
            "presentation": {
                "reveal": "always",
                "panel": "new"
            }
        },
        {
            "label": "Run CI Locally (Admin)",
            "type": "shell",
            "command": "act",
            "args": [
                "push",
                "--workflows",
                ".github/workflows/ci.yml"
            ],
            "options": {
                "shellExecutionOptions": {
                    "runAsAdmin": true
                }
            },
            "group": "test",
            "presentation": {
                "reveal": "always",
                "panel": "new"
            }
        }
    ]
}